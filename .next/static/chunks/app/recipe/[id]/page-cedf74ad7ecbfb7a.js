(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[316],{5593:function(e,t,a){Promise.resolve().then(a.bind(a,4607))},4607:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var s=a(7437),r=a(2265),i=a(9376),n=a(6285),o=a(6595),c=a(8997),l=a(9711),d=a(4356),m=a(3297);function p(){let{id:e}=(0,i.useParams)(),t=(0,i.useRouter)(),[a,p]=(0,r.useState)(null),[x,u]=(0,r.useState)(!0),[h,g]=(0,r.useState)(""),[f,y]=(0,r.useState)(!1),[b,j]=(0,r.useState)(!1),[w,v]=(0,r.useState)(null),[N,k]=(0,r.useState)(null),[S,_]=(0,r.useState)([]),[E,C]=(0,r.useState)(""),[I,Z]=(0,r.useState)(null),[T,O]=(0,r.useState)("");(0,r.useEffect)(()=>{j(!!localStorage.getItem("user_id"))},[]),(0,r.useEffect)(()=>{let t=async()=>{try{let t="".concat("https://recipe-app-backend-a8du.onrender.com/api","/recipes/").concat(e,"/ratings"),a=await fetch(t),s=await a.json();a.ok&&k(Number(s.average_rating))}catch(e){console.error("Error fetching rating:",e)}},a=async()=>{try{let t="".concat("https://recipe-app-backend-a8du.onrender.com/api","/recipes/").concat(e,"/comments"),a=await fetch(t),s=await a.json();a.ok&&_(s)}catch(e){console.error("Error fetching comments:",e)}};(async()=>{try{let t="".concat("https://recipe-app-backend-a8du.onrender.com/api","/recipes/").concat(e),a=await fetch(t),s=await a.json();if(!a.ok)throw Error(s.message||"Failed to fetch recipe");let r="string"==typeof s.ingredients?s.ingredients.split("|").map(e=>e.trim()):s.ingredients,i="string"==typeof s.instructions?s.instructions.split(".").map(e=>e.trim()).filter(e=>e.length>0):s.instructions;p({...s,ingredients:r,instructions:i})}catch(e){console.error("Error fetching recipe:",e),g(e.message)}finally{u(!1)}})(),t(),a()},[e]);let L=async()=>{let e=localStorage.getItem("user_id");if(!e||!(null==a?void 0:a.id)){console.error("Missing user_id or recipe_id");return}try{let t=await fetch(f?"".concat("https://recipe-app-backend-a8du.onrender.com/api","/recipes/remove-favorite"):"".concat("https://recipe-app-backend-a8du.onrender.com/api","/recipes/save-favorite"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:parseInt(e),recipe_id:a.id})}),s=await t.json();if(!t.ok)throw Error(s.message||"Failed to update favorite");y(!f)}catch(e){console.error("Error toggling favorite:",e)}},F=async t=>{let s=localStorage.getItem("user_id");if(!s||!(null==a?void 0:a.id)){console.error("User ID or recipe ID is missing");return}try{let a="".concat("https://recipe-app-backend-a8du.onrender.com/api","/recipes/").concat(e,"/rate"),r=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:parseInt(s),rating:t})});if(r.ok){v(t);let a=await fetch("".concat("https://recipe-app-backend-a8du.onrender.com/api","/recipes/").concat(e,"/ratings")),s=await a.json();k(Number(s.average_rating))}else{let e=await r.json();throw Error(e.message||"Failed to submit rating")}}catch(e){console.error("Error submitting rating:",e)}},P=async()=>{let t=localStorage.getItem("user_id");if(t&&E.trim())try{let a="".concat("https://recipe-app-backend-a8du.onrender.com/api","/recipes/").concat(e,"/comment"),s=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:parseInt(t),comment_text:E})}),r=await s.json();if(s.ok)_([r,...S]),C("");else throw Error(r.message||"Failed to post comment")}catch(e){console.error("Error posting comment:",e)}},M=async e=>{let t=localStorage.getItem("user_id");if(t)try{let a="".concat("https://recipe-app-backend-a8du.onrender.com/api","/recipes/comments/").concat(e),s=await fetch(a,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:parseInt(t),comment_text:T})}),r=await s.json();if(!s.ok)throw Error(r.message||"Failed to update comment");_(t=>t.map(t=>t.id===e?{...t,comment_text:T}:t)),Z(null),O("")}catch(e){console.error("Error updating comment:",e)}},J=async e=>{let t=localStorage.getItem("user_id");if(t)try{let a="".concat("https://recipe-app-backend-a8du.onrender.com/api","/recipes/comments/").concat(e),s=await fetch(a,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:parseInt(t)})}),r=await s.json();if(!s.ok)throw Error(r.message||"Failed to delete comment");_(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Error deleting comment:",e)}};return x?(0,s.jsx)(l.Z,{}):h?(0,s.jsx)("p",{className:"text-center text-red-500",children:h}):a?(0,s.jsxs)(n.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},className:"min-h-screen bg-gradient-to-br from-purple-100 to-pink-100",children:[(0,s.jsx)(d.Z,{isLoggedIn:b,handleLogout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user_id"),j(!1),t.push("/")}}),(0,s.jsxs)("div",{className:"max-w-4xl mx-auto px-6 sm:px-8 lg:px-12 py-12 bg-white shadow-lg rounded-2xl relative mt-8 mb-8",children:[(0,s.jsx)("button",{onClick:()=>{t.back()},className:"bg-purple-500 text-white px-2 py-1 text-xs sm:px-4 sm:py-2 sm:text-base rounded hover:bg-purple-600 absolute top-4 right-4 z-30",children:"Go Back"}),(0,s.jsx)(n.E.h1,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},className:"text-2xl sm:text-4xl font-bold text-gray-800 mb-6 text-center",children:a.name}),(0,s.jsxs)("div",{className:"relative w-full h-80",children:[a.video_url?(0,s.jsx)(n.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.6},className:"w-full h-full",children:(0,s.jsx)("iframe",{src:a.video_url.replace("watch?v=","embed/"),title:a.name,allowFullScreen:!0,className:"w-full h-full rounded-lg shadow-md"})}):(0,s.jsx)(n.E.img,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.6},src:"/placeholder.svg",alt:a.name,className:"w-full h-80 object-cover rounded-lg shadow-md"}),b&&(0,s.jsx)("button",{onClick:L,className:"absolute top-3 left-3 z-20 text-red-500 hover:text-red-600 transition",children:(0,s.jsx)(c.Z,{className:"h-7 w-7 ".concat(f?"fill-red-500":"")})}),(0,s.jsxs)("div",{className:"absolute top-3 right-3 z-20 flex items-center bg-black bg-opacity-70 px-2 py-1 rounded-full",children:[(0,s.jsx)(o.Z,{className:"w-5 h-5 text-yellow-400"}),(0,s.jsx)("span",{className:"text-sm font-semibold text-white ml-1",children:null!=N?N:0})]})]}),(0,s.jsx)(n.E.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3,duration:.5},className:"text-gray-700 text-lg mt-6 text-center",children:a.description}),(0,s.jsxs)("div",{className:"mt-8",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Ingredients"}),(0,s.jsx)(n.E.div,{className:"flex flex-wrap gap-3",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.6},children:a.ingredients.map((e,t)=>(0,s.jsx)(n.E.span,{className:"bg-purple-200 text-purple-800 px-4 py-2 rounded-lg text-lg font-semibold shadow-sm",whileHover:{scale:1.1},children:e},t))})]}),(0,s.jsxs)("div",{className:"mt-10",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Instructions"}),(0,s.jsx)("div",{className:"space-y-4",children:a.instructions.map((e,t)=>(0,s.jsxs)(n.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5+.1*t,duration:.5},className:"bg-gray-50 p-5 rounded-lg shadow-md flex items-start space-x-4",children:[(0,s.jsx)("div",{className:"bg-green-500 text-white rounded-full h-10 w-10 flex items-center justify-center text-lg font-semibold",children:t+1}),(0,s.jsx)("p",{className:"text-gray-700 text-lg leading-relaxed",children:e})]},t))})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center mt-10",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-2",children:"Rate this Recipe"}),(0,s.jsx)("div",{className:"flex",children:[1,2,3,4,5].map(e=>(0,s.jsx)("button",{onClick:()=>b?F(e):console.warn("User must be logged in to rate"),className:"focus:outline-none",disabled:!b,children:(0,s.jsx)(o.Z,{className:"w-8 h-8 cursor-pointer transition duration-300 ".concat(e<=(w||N||0)?"text-yellow-400":"text-gray-300")})},e))}),!b&&(0,s.jsx)("p",{className:"text-gray-500 text-sm mt-2",children:"Log in to rate this recipe."})]}),(0,s.jsxs)("div",{className:"mt-10",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-4 text-center",children:"Comments"}),b&&(0,s.jsxs)("div",{className:"mb-4 flex flex-col items-center",children:[(0,s.jsx)("textarea",{className:"w-full p-3 border rounded-md",placeholder:"Write a comment...",value:E,onChange:e=>C(e.target.value)}),(0,s.jsx)("button",{onClick:P,className:"px-4 py-2 bg-purple-500 text-white font-semibold rounded-lg hover:bg-purple-600 transition mt-2",children:"Post Comment"})]}),(0,s.jsx)("div",{className:"space-y-4",children:S.map(e=>(0,s.jsxs)("div",{className:"bg-gray-100 p-3 rounded-md",children:[(0,s.jsx)("p",{className:"text-sm font-semibold",children:e.username}),I===e.id?(0,s.jsxs)("div",{children:[(0,s.jsx)("textarea",{className:"w-full p-2 border rounded-md",value:T,onChange:e=>O(e.target.value)}),(0,s.jsxs)("div",{className:"mt-2 space-x-2 flex justify-center",children:[(0,s.jsx)("button",{onClick:()=>M(e.id),className:"px-2 py-1 text-xs sm:px-4 sm:py-2 sm:text-base bg-pink-500 text-white font-semibold rounded-lg hover:bg-pink-600 transition",children:"Save"}),(0,s.jsx)("button",{onClick:()=>{Z(null),O("")},className:"px-2 py-1 text-xs sm:px-4 sm:py-2 sm:text-base bg-purple-500 text-white font-semibold rounded-lg hover:bg-purple-600 transition",children:"Cancel"})]})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{children:e.comment_text}),b&&localStorage.getItem("user_id")===String(e.user_id)&&(0,s.jsxs)("div",{className:"mt-2 space-x-2 flex justify-center",children:[(0,s.jsx)("button",{onClick:()=>{Z(e.id),O(e.comment_text)},className:"px-2 py-1 text-xs sm:px-4 sm:py-2 sm:text-base bg-pink-500 text-white font-semibold rounded-lg hover:bg-pink-600 transition",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>J(e.id),className:"px-2 py-1 text-xs sm:px-4 sm:py-2 sm:text-base bg-purple-500 text-white font-semibold rounded-lg hover:bg-purple-600 transition",children:"Delete"})]})]})]},e.id))})]})]}),(0,s.jsx)(m.Z,{})]}):(0,s.jsx)("p",{className:"text-center text-gray-500",children:"Recipe not found."})}},9711:function(e,t,a){"use strict";var s=a(7437);t.Z=()=>(0,s.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,s.jsxs)("svg",{width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsxs)("g",{transform:"rotate(0 50 50)",children:[(0,s.jsx)("path",{fill:"#ffcc66",stroke:"#cc9900",strokeWidth:"2",d:"M30 70 Q50 90 70 70 L75 90 Q50 95 25 90 Z"}),(0,s.jsx)("path",{fill:"#ff99cc",stroke:"#cc6699",strokeWidth:"2",d:"M35 55 Q50 35 65 55 Q75 40 50 30 Q25 40 35 55 Z"}),(0,s.jsx)("circle",{cx:"50",cy:"28",r:"5",fill:"#ff3333"})]}),(0,s.jsx)("animateTransform",{attributeType:"XML",attributeName:"transform",type:"rotate",from:"0 50 50",to:"360 50 50",dur:"1s",repeatCount:"indefinite"})]})})},8997:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9205).Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},6595:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9205).Z)("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])}},function(e){e.O(0,[448,140,196,971,117,744],function(){return e(e.s=5593)}),_N_E=e.O()}]);